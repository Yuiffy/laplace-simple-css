# 弹幕条件逻辑使用说明

## 问题背景

CSS 本身**无法直接读取和判断文本内容**，但是可以通过 **HTML 属性选择器** 来实现条件逻辑！

## 解决方案

✅ **纯 CSS 实现**（推荐）

由于弹幕机的 HTML 中已经包含了 `data-uid` 属性，我们可以直接使用 CSS 属性选择器来判断用户：

```css
/* 只对 UID 为 401742377 的用户显示"危"字 */
.can-motion .event--superchat[data-uid="401742377"]:nth-last-child(-n+2)::after {
  content: "危";
  /* ...其他样式... */
}
```

**不需要任何 JavaScript！** 🎉

## 使用方法

### 在 OBS 浏览器源中使用

1. 在 OBS 中添加浏览器源，URL 使用你的弹幕机地址
2. 在浏览器源的**自定义 CSS** 中粘贴 `danmaku.css` 的内容
3. ~~不需要添加 JavaScript~~（已改为纯 CSS 实现）

### 在本地 HTML 测试文件中使用

```html
<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="danmaku.css">
</head>
<body>
  <!-- 弹幕机 iframe -->
  <iframe src="你的弹幕机URL"></iframe>
  
  <!-- 在页面底部引入脚本 -->
  <script src="danmaku-logic.js"></script>
</body>
</html>
```

## 自定义配置

### 修改触发用户的 UID

在 `danmaku.css` 中找到这一行：
```css
.can-motion .event--superchat[data-uid="401742377"]:nth-last-child(-n+2)::after {
```

将 `401742377` 改为你想要的用户 UID。

### 支持多个用户

如果想让多个用户都显示"危"字，可以添加多个选择器：

```css
/* 为多个用户显示"危"字 */
.can-motion .event--superchat[data-uid="401742377"]:nth-last-child(-n+2)::after,
.can-motion .event--superchat[data-uid="另一个UID"]:nth-last-child(-n+2)::after,
.can-motion .event--superchat[data-uid="再一个UID"]:nth-last-child(-n+2)::after {
  content: "危";
  /* ...样式... */
}
```

### 如何获取用户的 UID

1. 打开弹幕机页面
2. 按 F12 打开开发者工具
3. 在 Elements 标签中找到 SC 消息的 div
4. 查看 `data-uid` 属性的值


### 修改"危"字样式

在 `danmaku.css` 中找到这一段：
```css
.can-motion .event--superchat[data-show-danger="true"]:nth-last-child(-n+2)::after {
  content: "危";  /* 可以改成其他文字 */
  font-size: 180px;  /* 调整大小 */
  color: rgba(255, 0, 0, 1.0);  /* 调整颜色 */
  /* ...其他样式... */
}
```

## CSS 的逻辑能力总结

### CSS 能做的：
✅ 根据 HTML 属性判断：`[data-attr="value"]`  
✅ 根据元素状态判断：`:hover`, `:focus`, `:checked`  
✅ 根据元素位置判断：`:first-child`, `:nth-child()`  
✅ 根据父子关系判断：`:has()` (现代浏览器)  
✅ 简单的数值计算：`calc()`  

### CSS 不能做的：
❌ 读取元素的文本内容  
❌ 判断文本内容是否等于某个值  
❌ 复杂的逻辑运算（if-else, 循环等）  
❌ 访问外部数据或 API  

## 技术原理

这个方案使用了 **CSS 属性选择器**：

```
1. 弹幕机在渲染 SC 消息时，自动在 HTML 元素上添加 data-uid 属性
   例如：<div class="event--superchat" data-uid="401742377">
   ↓
2. CSS 使用属性选择器匹配特定 UID
   [data-uid="401742377"]
   ↓
3. 只有匹配的元素会应用"危"字样式
   ↓
4. 显示"危"字动画效果
```

**完全不需要 JavaScript！** 这是纯 CSS 的条件逻辑实现。

## CSS 属性选择器语法

```css
/* 精确匹配 */
[data-uid="401742377"]  /* UID 完全等于这个值 */

/* 包含匹配 */
[data-uid*="4017"]      /* UID 包含 "4017" */

/* 开头匹配 */
[data-uid^="401"]       /* UID 以 "401" 开头 */

/* 结尾匹配 */
[data-uid$="377"]       /* UID 以 "377" 结尾 */
```

## 注意事项

1. **UID 必须完全匹配**（包括所有数字），否则不会生效
2. **不需要加载任何 JavaScript**，纯 CSS 即可工作
3. **性能优秀**，CSS 属性选择器的性能非常好
4. **兼容性好**，所有现代浏览器都支持属性选择器
